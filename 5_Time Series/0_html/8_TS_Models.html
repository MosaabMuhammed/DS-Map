<!DOCTYPE HTML>
<html>

<head>
    <meta charset="utf-8" />
    <title>
        TS Models
    </title>
    <link rel="stylesheet" href="../../prism.css">
</head>

<body>
    <h1 id="2-forecasting">
        2. Forecasting
    </h1>
    <div style="width:1000px;margin:auto">

        <details>
            <summary><b>Intro to Forecasting</b></summary>
            <a href="./9_models/00-Introduction-to-Forecasting-Revised.html"><strong>Halt-Winter - Evaluation - Stationary</strong></a></p>
        </details>
        <!-- --------------------------- ----------------------------- -->
        <details>
            <summary><b>ACF and PACF</b></summary>
            <a href="./9_models/01-ACF-and-PACF.html"><strong>ACF - PACF - Autocorrelations - more</strong></a>
        </details>
        <!-- --------------------------- ----------------------------- -->
        <details>
            <summary><b>ARIMA Models</b></summary>
            <ul>
                <details>
                    <summary>AR Model</summary>
                    <p>An autoregressive (AR) model is a representation of a type of random process; as such, it is used to describe certain time-varying processes in nature, economics, etc.<br> The autoregressive model specifies that the output variable
                        depends linearly on its own previous values and on a stochastic term (an imperfectly predictable term); thus the model is in the form of a stochastic difference equation.</p>
                    <pre class="language-python"><code># Create a simulated process.
# AR(1) model
# Rt = μ + ϕRt-1 + εt
# As RHS has only one lagged value(Rt-1)this is called AR model of order 1 where μ is mean and ε is noise at time t
# AR(1) MA(1) model:AR parameter = +0.9
from statsmodels.tsa.arima_model import ARMA
from statsmodels.tsa.arima_process import ArmaProcess
from statsmodels.tsa.arima_model import ARIMA
import math
from sklearn.metrics import mean_squared_error

rcParams['figure.figsize'] = 16, 12
plt.subplot(4,1,1)
ar1 = np.array([1, -0.9]) # We choose -0.9 as AR parameter is +0.9
ma1 = np.array([1])
AR1 = ArmaProcess(ar1, ma1)
sim1 = AR1.generate_sample(nsample=1000)
plt.title('AR(1) model: AR parameter = +0.9')
plt.plot(sim1)
</code></pre>
                    <img src="../0_html/imgs/ar.png" alt="">
                    <pre class="language-python"><code># Forecasting.
model = ARMA(sim1, order=(1,0))
result = model.fit()
print(result.summary())
print("μ={} ,ϕ={}".format(result.params[0],result.params[1]))

ARMA Model Results                              
==============================================================================
Dep. Variable:                      y   No. Observations:                 1000
Model:                     ARMA(1, 0)   Log Likelihood               -1415.701
Method:                       css-mle   S.D. of innovations              0.996
Date:                Thu, 02 Aug 2018   AIC                           2837.403
Time:                        14:43:19   BIC                           2852.126
Sample:                             0   HQIC                          2842.998
                                                                              
==============================================================================
                 coef    std err          z      P>|z|      [0.025      0.975]
------------------------------------------------------------------------------
const          0.7072      0.288      2.454      0.014       0.142       1.272
ar.L1.y        0.8916      0.014     62.742      0.000       0.864       0.919
                                    Roots                                    
=============================================================================
                 Real           Imaginary           Modulus         Frequency
-----------------------------------------------------------------------------
AR.1            1.1216           +0.0000j            1.1216            0.0000
-----------------------------------------------------------------------------
μ=0.7072025170552714 ,ϕ=0.8915815634822984
</code></pre>
                    <pre class="language-python"><code># Forecasting.
# Predicting simulated AR(1) model 
result.plot_predict(start=900, end=1010)
plt.show()
</code></pre>
                    <img src="../0_html/imgs/ar-forecast.png" alt="" width="600" height="400">
                    <pre class="language-python"><code>rmse = math.sqrt(mean_squared_error(sim1[900:1011], result.predict(start=900,end=999)))
print("The root mean squared error is {}.".format(rmse))
# The root mean squared error is 1.0408054544358292.
# y is predicted plot. Quite neat!
                </code></pre>
                </details>
            </ul>
        </details>

        <!-- --------------------------- ----------------------------- -->
    </div>
    <script src="../../prism.js"></script>
</body>

</html>